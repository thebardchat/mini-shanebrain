# MINI-SHANEBRAIN: Facebook Automation Bot

## Quick Win Project — Built with Claude Code

**Repo:** https://github.com/thebardchat/mini-shanebrain
**Purpose:** AI-powered Facebook Page automation — auto-generate and schedule posts using local ShaneBrain intelligence

---

## PHASE 1: Facebook Developer Setup (Do This First — 10 Minutes)

### Step 1: Create a Meta Developer Account
1. Go to **https://developers.facebook.com**
2. Click **"Get Started"**
3. Log in with your personal Facebook account
4. Complete verification (phone number, email)
5. Accept the developer terms

### Step 2: Create a Meta App
1. Go to **https://developers.facebook.com/apps/**
2. Click **"Create App"**
3. **App name:** `mini-shanebrain`
4. **Contact email:** your email
5. Click **Create App**
6. On "Add use cases" → select **"Other"** at the bottom
7. On "App type" → select **"Business"** (or "None" for personal use)
8. Click **Create App**

### Step 3: Get Your Facebook Page ID
- If your page is part of a Business Portfolio:
  `https://business.facebook.com/latest/settings/pages` → copy the Page ID
- If NOT part of a Business Portfolio:
  Go to your Facebook Page → About → scroll down → **Page ID** is listed there

### Step 4: Generate Access Token (Graph API Explorer)
1. Go to **https://developers.facebook.com/tools/explorer/**
2. Under **"Meta App"** dropdown → select `mini-shanebrain`
3. Under **"User or Page"** → select **"Get Page Access Token"**
4. Click **"Add a Permission"** and add these:
   - `pages_manage_posts`
   - `pages_read_engagement`
   - `pages_show_list`
   - `pages_manage_engagement`
   - `publish_video` (optional, for video posts later)
5. Click the blue **"Generate Access Token"** button
6. Approve permissions in the popup
7. Select your Facebook Page when prompted
8. **Copy the token** — you'll need it

### Step 5: Make the Token Long-Lived (So It Doesn't Expire in 1 Hour)
1. Go to **App Settings → Basic** in your developer dashboard
2. Copy your **App ID** and **App Secret**
3. In your browser, visit this URL (replace the values):

```
https://graph.facebook.com/oauth/access_token?grant_type=fb_exchange_token&client_id=YOUR_APP_ID&client_secret=YOUR_APP_SECRET&fb_exchange_token=SHORT_LIVED_TOKEN_FROM_STEP_4
```

4. Copy the `access_token` from the JSON response — this lasts ~60 days

### Step 6: Get a Never-Expiring Page Token
1. Go to **https://developers.facebook.com/tools/debug/accesstoken/**
2. Paste your long-lived token → click **Debug**
3. Confirm it shows extended expiration
4. Now visit this URL in browser:

```
https://graph.facebook.com/v21.0/me/accounts?access_token=YOUR_LONG_LIVED_TOKEN
```

5. Find your page in the JSON response
6. Copy the `access_token` for your page — **this one never expires**

---

## PHASE 2: Clone & Configure with Claude Code

### Step 1: Clone the Repo
```bash
cd D:\Angel_Cloud\shanebrain-core
git clone https://github.com/thebardchat/mini-shanebrain.git
cd mini-shanebrain
```

### Step 2: Initialize the Project with Claude Code
Open Claude Code in the `mini-shanebrain` directory:
```bash
claude
```

Then tell Claude Code:
```
Read CLAUDE.md for project context, then initialize this as a Node.js project 
for a Facebook Page automation bot. Use the Facebook Graph API to auto-post 
content. Store secrets in a .env file (already in .gitignore).
```

### Step 3: Secrets Setup
Create a `.env` file (Claude Code can do this):

```env
# Facebook Graph API
FB_PAGE_ID=your_page_id_here
FB_PAGE_ACCESS_TOKEN=your_never_expiring_page_token_here
FB_APP_ID=your_app_id_here
FB_APP_SECRET=your_app_secret_here

# Anthropic API (for AI-generated content)
ANTHROPIC_API_KEY=your_claude_api_key_here

# Optional: Ollama local (if you want to use local LLM instead)
OLLAMA_URL=http://localhost:11434
OLLAMA_MODEL=llama3.2:1b
```

**IMPORTANT:** Make sure `.env` is in `.gitignore` so secrets never hit GitHub.

---

## PHASE 3: Tell Claude Code What to Build

### The CLAUDE.md File (Put This in Your Repo Root)

Create `CLAUDE.md` in the mini-shanebrain repo:

```markdown
# MINI-SHANEBRAIN — Facebook Automation Bot

## What This Is
A Node.js bot that auto-generates and posts content to a Facebook Page 
using the Facebook Graph API v21.0. Content is generated by Claude API 
(or optionally local Ollama llama3.2:1b).

## Architecture
- **Runtime:** Node.js
- **API:** Facebook Graph API v21.0
- **AI:** Anthropic Claude API (primary) or Ollama (local fallback)
- **Secrets:** .env file (never commit)
- **Scheduling:** node-cron or Windows Task Scheduler

## File Structure
```
mini-shanebrain/
├── CLAUDE.md           # This file — project context for Claude Code
├── .env                # Secrets (in .gitignore)
├── .gitignore          # Excludes .env, node_modules, logs
├── package.json        # Dependencies
├── src/
│   ├── index.js        # Main entry point
│   ├── facebook.js     # Facebook Graph API wrapper
│   ├── ai.js           # AI content generation (Claude API + Ollama fallback)
│   ├── scheduler.js    # Cron job scheduling
│   └── prompts/
│       └── post-templates.js  # Post generation prompts
├── config/
│   └── topics.json     # Topics/themes for auto-generated posts
└── logs/
    └── posts.json      # Log of all published posts
```

## Key Endpoints
- POST to Page: `POST https://graph.facebook.com/v21.0/{page-id}/feed`
  - Body: `{ message: "post text", access_token: "token" }`
- Post with Image: `POST https://graph.facebook.com/v21.0/{page-id}/photos`
  - Body: `{ url: "image_url", caption: "text", access_token: "token" }`

## Rules
- Never commit .env or secrets
- All posts get logged to logs/posts.json with timestamp
- Rate limit: Don't post more than once per hour
- AI-generated content must align with Angel Cloud values (positive, uplifting)
- Include error handling and retry logic for API calls
```

### The Prompt to Give Claude Code

Once you have CLAUDE.md in place and .env configured, tell Claude Code:

```
Build the mini-shanebrain Facebook bot based on CLAUDE.md. Start with:
1. npm init and install dependencies (dotenv, node-fetch, anthropic, node-cron)
2. Build facebook.js — wrapper for Graph API posting
3. Build ai.js — generate post content using Claude API
4. Build index.js — tie it together with a simple CLI
5. Test with a dry-run mode that shows the post without publishing
6. Add scheduler.js for automated posting on a cron schedule

Make it work on Windows. Keep it lean for low-RAM systems.
```

---

## PHASE 4: Test & Run

### Dry Run (Preview Post Without Publishing)
```bash
node src/index.js --dry-run
```

### Post Once
```bash
node src/index.js --post
```

### Start Scheduler (Auto-Post Every X Hours)
```bash
node src/index.js --schedule
```

### Run via Windows Task Scheduler
Create a `.bat` file:
```batch
@echo off
cd /d D:\Angel_Cloud\shanebrain-core\mini-shanebrain
node src/index.js --post >> logs\scheduler.log 2>&1
```
Schedule it in Task Scheduler for whatever frequency you want.

---

## QUICK REFERENCE

| What | Where |
|------|-------|
| Facebook Developer Portal | https://developers.facebook.com |
| Graph API Explorer | https://developers.facebook.com/tools/explorer/ |
| Access Token Debugger | https://developers.facebook.com/tools/debug/accesstoken/ |
| Graph API Docs | https://developers.facebook.com/docs/graph-api/ |
| Your Repo | https://github.com/thebardchat/mini-shanebrain |
| Secrets | `.env` file (local only, never committed) |

---

## SECURITY NOTES

- `.env` stores ALL secrets — never push to GitHub
- Page access tokens that "never expire" still need refresh if you change page permissions
- App Secret is sensitive — treat it like a password
- If token stops working, repeat Steps 4-6 in Phase 1
- Claude Code can help regenerate tokens via CLI if needed

---

## WHAT'S NEXT (After Quick Win)

- [ ] Add image generation for posts (DALL-E or local Stable Diffusion)
- [ ] Add Instagram cross-posting (same Graph API, add `instagram_content_publish` permission)
- [ ] Connect to ShaneBrain Core on Pi 5 for local AI post generation
- [ ] Add analytics — pull post engagement metrics via Graph API
- [ ] Build a dashboard to see post performance
